# 部署到微信云托管

## 前置准备

1. **微信开发者工具** - 下载最新版本
2. **开通云托管** - 在微信开发者工具中：云开发 -> 云托管 -> 开通

## 部署步骤

### 方式一：使用微信开发者工具（推荐）

1. 在微信开发者工具中打开项目 `footballLineUp`
2. 点击「云开发」->「云托管」
3. 点击「开通环境」，等待创建完成
4. 在「服务列表」中点击「创建服务」
   - 服务名：`football-api`
   - 端口：`4000`
5. 上传部署：
   - 点击服务 ->「上传镜像」
   - 选择 Dockerfile 所在目录
   - 或使用「自动构建」（需要配置 CI/CD）

### 方式二：使用命令行

```bash
# 1. 安装 cloudbase CLI
npm install -g @cloudbase/cli

# 2. 登录
tcb login

# 3. 部署（需要先构建 Docker 镜像）
tcb service deploy football-api -e envId
```

## 环境变量配置

在云托管控制台 -> 服务 -> 「配置」中设置：

| 变量名 | 说明 | 示例值 |
|--------|------|--------|
| DB_HOST | 数据库地址 | 你的MySQL地址 |
| DB_USER | 数据库用户名 | root |
| DB_PASSWORD | 数据库密码 | 123456 |
| DB_NAME | 数据库名 | pitchmaster |
| PORT | 服务端口 | 4000 |

## 数据库

微信云托管**不提供 MySQL**，需要：
- 使用 **腾讯云数据库 MySQL**（推荐）
- 或使用已有的 MySQL 服务

## 访问

部署成功后，云托管会自动提供 HTTPS 访问地址，格式为：
`https://{service}-{env}.tcloudbaseapp.com`

## 注意事项

1. 数据库需要在云托管的「私有网络」中，或开启公网访问
2. 微信云托管提供免费额度，个人使用基本免费
3. 前端调用 API 时需修改 BASE_URL 为云托管提供的地址
